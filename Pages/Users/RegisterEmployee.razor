@page "/registeremployee"
@inject IEmployeeService employeeService
@using System.Net.Http.Json
@using System.ComponentModel.DataAnnotations
@using TimeTrackerClient.Services.Base
@using TimeTrackerClient.Services.Employee

<h3 style="margin-bottom: 20px;">Register Employee</h3>

@if (!string.IsNullOrEmpty(successMessage))
{
    <div style="color: green; margin-bottom: 10px;">@successMessage</div>
}

@if (!string.IsNullOrEmpty(errorMessage))
{
    <div style="color: red; margin-bottom: 10px;">@errorMessage</div>
}

<EditForm Model="dto" OnValidSubmit="HandleRegister" style="max-width: 400px;">
    <DataAnnotationsValidator />
    <ValidationSummary style="color: red;" />

    <div style="margin-bottom: 10px;">
        <label>Email</label>
        <InputText @bind-Value="dto.Email" style="width: 100%; padding: 5px;" />
    </div>

    <div style="margin-bottom: 10px;">
        <label>Password</label>
        <InputText @bind-Value="dto.Password" type="password" style="width: 100%; padding: 5px;" />
    </div>

    <div style="margin-bottom: 10px;">
        <label>Full Name</label>
        <InputText @bind-Value="dto.FullName" style="width: 100%; padding: 5px;" />
    </div>

    <div style="margin-bottom: 10px;">
        <label>Hourly Wage</label>
        <InputNumber @bind-Value="dto.HourlyWage" style="width: 100%; padding: 5px;" />
    </div>

    <div style="margin-bottom: 10px;">
        <label>Personal Number</label>
        <InputText @bind-Value="dto.PersonalNumber" style="width: 100%; padding: 5px;" />
    </div>

    <div style="margin-bottom: 10px;">
        <label>Phone Number</label>
        <InputText @bind-Value="dto.PhoneNumber" style="width: 100%; padding: 5px;" />
    </div>

    <div style="margin-bottom: 10px;">
        <label>Address</label>
        <InputText @bind-Value="dto.Address" style="width: 100%; padding: 5px;" />
    </div>

    <div style="margin-bottom: 10px;">
        <label>Emergency Contact</label>
        <InputText @bind-Value="dto.EmergencyContact" style="width: 100%; padding: 5px;" />
    </div>

    <div>
        <button type="submit" style="padding: 6px 12px; background-color: #4CAF50; color: white; border: none;">Register</button>
    </div>
</EditForm>

@code {
    private RegisterEmployeeDto dto = new();
    private string? successMessage;
    private string? errorMessage;

    private async Task HandleRegister()
    {
        successMessage = null;
        errorMessage = null;

        var response = await employeeService.RegisterEmployeeAsync(dto);

        if (response.Success)
        {
            successMessage = "Registration Successfull";
            dto = new(); // Clear form
        }
        else
        {
            errorMessage = response.Message ?? "Registration failed.";
        }
    }
}